---
title: "Modeling Linear Combinations of Multiple Pollutants"
output:
  pdf_document:
    latex_engine: xelatex
header-includes:
  - \usepackage{fontspec}
bibliography: CANSSI_Grant.bib
geometry: margin=1in 
fontsize: 12pt
documentclass: article
classoption: letterpaper
---

\setmainfont{Calibri}

# Name and affiliations of lead investigators

Name: Professor Patrick Brown <br/>  
Affiliations: Centre for Global Health Research, St. Michael's Hospital <br/>  
             \hspace*{52.5pt} Department of Statistical Sciences, University of Toronto

Name: Professor Fateh Chebana <br/>  
Affiliation: Institut national de la recherche scientifique (INRS)

Name: Professor Cindy Feng <br/>  
Affiliation: School of Epidemiology and Public Health, University of Ottawa



# List of proposed callaborators, titles, and affiliations

Name: Kamal Rai <br/>  
Title: Post-Doctoral Fellow (?) <br/>  
Affiliations: Centre for Global Health Research, St. Michael's Hospital <br/>  
             \hspace*{52.5pt} Department of Statistical Sciences, University of Toronto


Name: Hwashin Shin <br/>  
Title: Adjunct Associate Professor (?) <br/>  
Affiliations: Environmental Health Science and Research Bureau, Health Canada <br/>  
             \hspace*{52.5pt} Department of Mathematics and Statistics, Queen's University 

Name: Pierre Masselot <br/>  
Title: Post-Doctoral Fellow (?) <br/>    
Affiliation: London School of Hygiene & Tropical Medicine
   

# List of potential partner organizations (optional)

Centre for Global Health Research, St. Michael's Hospital  <br/>  
Institut National de Santé Publique du Québec (?) <br/>  
Health Canada 


\newpage

# Research Aims

<!-- Limit to 5 pages, including references (include all details). Will be expanded to 7 pages in the full proposal -->

We propose to develop a fully Bayesisan implementation of the *groupwise additive index model* (GAIM), a constrained frequentist version of which is introduced in @pierre2020aim. For response distribution $D$ with a d-dimensional parameter $\theta = (\theta_{1},\ldots,\theta_{d})$ and link function $g$, the GAIM is,

$$
\begin{aligned}
  Y_{t} | \theta_{t} &= D( \theta ), \\
  g( \theta ) &= X\beta + 
        \sum\limits_{i=1}^{I} s_{i}(\alpha_{1}\gamma_{1,t} + \ldots + \alpha_{n_{i}}\gamma_{n_{i},t})+ 
        \sum\limits_{k=1}^{K} f_{k}( \eta_{k} )
\end{aligned}
$$
In the above, $Y_{t}$ is the outcome of interest, $X$ is a design matrix, and $\beta$ is a vector of fixed effects. The second sum consists of $K$ smoothing functions $f_{1}, \ldots, f_{K}$ applied to $K$ potential confounders $\eta_{k} = (\eta_{1}, \ldots, \eta_{n_{k}}$). The novelty of the GAIM lies in the first sum, which fits smooth functions $s_{i}$ to a weighted sum of potentially time-varying covariates. 

The GAIM is a flexible and extensible statistical model with a wide variety of potential applications, as the researcher can choose the number $I$ of smooth functions $s_{i}$ and the number of covariates $n_{i}$ in each $s_{i}$. Possible epidemiological applications include examining the health effects of environmental exposures, such as chemical mixtures, metal mixtures, pesticides, and mixtures of air pollutants [@sanders2015perinatal; @braun2016can; @lazarevic2019statistical; @bobb2015bayesian]. For example, a possible air pollution model could have one smooth function $s_{1}$ and two covariates $\gamma_{1,t}$ and $\gamma_{2,t}$, where $\gamma_{1,t}$ is the (time-varying) concentration of ozone (O~3~) and $\gamma_{2,t}$ is the (time-varying) concentration of particulate matter less than 2.5 $\mu$g (PM~2.5~). In this case, the weights $\alpha = (\alpha_{1}, \alpha_{2})$ give the *relative* contribution of O~3~ and PM~2.5~ to the health outcome of interest. Another possible model could have 3 additional pollutants -- nitrogen dioxide (NO~2~), sulfur dioxide (SO~2~), and particulate matter less than 10 $\mu$g (PM~10~) -- such that the 5 weights $\alpha$ give the *relative* contribution of each pollutant. The models could also include interaction terms, or additional smooth functions $s_{i}$ that group the pollutants in a scientifically justified way.

To explore the benefits of the GAIM, we next compare it to a standard regression model and one where the $s_{i}$ have a more general form. To ease notation, let us assume there are no confounders, one smooth function $s_{1}$, and two covariates, $\gamma_{1,t}$ and $\gamma_{2,t}$, in $s_{1}$. Then, these 3 models have link functions,
$$
\begin{aligned}
  g( \theta ) &= X\beta + \alpha_{1}\gamma_{1} + \alpha_{2}\gamma_{2} & \hspace{100pt} \text{ (1)  } \\
  g( \theta ) &= X\beta + s_{1}(\alpha_{1}\gamma_{1} + \alpha_{2}\gamma_{2}) & \hspace{100pt} \text{ (2) } \\
  g( \theta ) &= X\beta + s_{1}^{*}(\gamma_{1}, \gamma_{2}) & \hspace{100pt} \text{ (3) } \\
\end{aligned}
$$
(1) specifies a regression model with 2 fixed effects, $\alpha_{1}$ and $\alpha_{2}$, (2) specifies a GAIM with 2 weights $\alpha_{1}$ and $\alpha_{2}$, and (3) specifies $s_{1}^{*}$ as a 2-dimensional smoothing function. Compared to the linear regression in (1), the GAIM is more flexible. The inclusion of $s_{1}$ allows it to capture nonlinearities in the relationship between $\gamma_{1,t}$, $\gamma_{2,t}$ and the outcome $Y_{t}$. Compared to (3), the GAIM is less computationally demanding -- $\alpha_{1}\gamma_{1,t} + \alpha_{2}\gamma_{2,t}$ is always 1-dimensional, and remains so regardless of how many terms are the sum. This constrasts with $s^{*}_{1}$, whose dimensionality scales with its number of arguments. The GAIM is also more interpretable than (3). The *weights* $\alpha_{1}$ and $\alpha_{2}$ reflect the *relative* contribution of $\gamma_{1,t}$ and $\gamma_{2,t}$, respectively.  In comparison, $s^{*}_{1}(\gamma_{1},\gamma_{2})$ has no such weights, and often has *no* interpretable parameters.

We will develop a fully Bayesian implementation of the GAIM in Stan, a widely used statistical modeling language that performs inference using Hamiltonian Monte Carlo [@carpenter2017stan]. No Bayesian implementation of the GAIM currently exists; developing a robust implementation and releasing an R package would be a significant contribution towards accessible and interpretable dimension-reduction models with epidemiological applications. Developing a robust Bayesian implementation includes identifying suitable priors for the weights $\alpha$ and methods for imposing shape constraints, such as monotonicity and convexity, on the $s_{i}$. We will also develop non-MCMC inference methods for these models, and to characterize their performance under a wide variety of different applications. 



## Research Questions

In the course of this project, we will use the GAIM to explore the health effects of multiple air pollutants. Recent years have seen increased interest in modeling the joint effect of two or more pollutants in health outcomes [@dominici2010protecting; @billionnet2012estimating; @davalos2017current]. Bayesian approaches can be seen in @blangiardo2019hierarchical, @bobb2013reduced, and @huang2018multivariate. We will consider two research questions in the course of our inquiry, namely,
  
  1. What is the combined effect of multiple pollutants on various daily mortality outcomes?, and
  2. What is the relationship between daily COVID-19 mortality and air pollution? 
  
  
### Question 1

The workhorse of the (predominantly frequentist) air pollution literature is the one-pollutant log-linear Poisson regression model. This model accounts for confounders using fixed effects and smooth functions, such as the natural cubic spline [@samet2000fine; @dominici2002use; @liu2019ambient]. Let the *average* rate an outcome occurs on day $t$ be denoted by $\lambda_{t}$. Then, a typical one-pollutant model is, 

$$
\begin{aligned}
  Y_{t} | \lambda_{t} &= \text{Poisson}(\lambda_{t}), \\
  \log(\lambda_{t}) &= X\beta + \gamma_{1} P_{1,t} + \sum\limits_{k=1}^{K} f_{k}(\eta_{k}).
\end{aligned}
$$
Here, $Y_{t}$ is the health outcome of interest, such as respiratory mortality or morbidity. The design matrix $X$ contains day-of-the-week effects and seasonal terms, and the $f_{i}(\eta_{k,*})$ are smooth functions of potential confounders such as time and temperature. One extension of this model would fit $P_{1,t}$ to a smooth function $s_{1}$. More generally, we could fit $N$ pollutants to $N$ smooth functions, $s_{1}, \ldots, s_{N}$. A third alternative, which we propose here, is to model $N$ pollutants using the GAIM. 

Air pollution is an excellent application area for the GAIM. People are exposed to the mixture of pollutants in their environment, many of which are highly correlated [@guowen2020multi]. Thus, health effects the single pollutant model attributes to $P_{1}$ may very well be caused by a correlated pollutant, *or* only be present within certain combinations of a mixture of pollutants. @franklin2008impact found that the effect of ozone on non-accidental mortality was "substantially reduced" after adjusting for particle sulfate. In @liu2019ambient, the authors found statistically significant differences in the percentage change in all-cause mortality attributable to PM~2.5~ and PM~10~ when adjusting for either of NO~2~ *or* SO~2~.

Therefore, it is is crucial to extend the one-pollutant model in a way that attributes health effects to the *correct* (mixture of) pollutants. If we want to know the health impact of the mixture of pollutants being modeling, it is only natural to model the pollutants as a mixture. Therefore, the most informative extension of the one pollutant model is one that conducts inference on a mixture of pollutants in the model. Using a nonlinear function of the weighted sum has advantages, as there is evidence that some health outcomes are nonlinearly related to pollution levels [@feng2016impact], and that synergistic effects occur when more than one pollutant is present at higher levels [@xia2006cumulative]. We propose using the GAIM in the multiple pollutant setting because it is particularly well-suited to estimating nonlinear effects of weighted sums: the value of smooth function $s_{i}$ is the (log) effect of its weighted sum on the health outcome of interest, and its weights $\alpha$ give the relative contribution of each component in the sum. 

A wide variety of statistical methods have been advanced for modeling multiple pollutants. Five appraches are detailed in @davalos2017current. Of these, adding additive main effects can present biased estimates in the presence of highly correlated variables, while nonparameteric methods are less interpretable than desired. The research teams and related stake-holders involved in air pollution research are often inter-disciplinary, such that it is crucial that model parameters be easily interpretable and the estimation results be very communicable. While the unsupervised dimension reduction methods (such as principle components analysis and k-means clustering) indentified in @davalos2017current are difficult to interpret, some of the supervised methods consider easier-to-interpret weighted sums of pollutant concentrations. In @pachon2012development, the authors specify weights from data rather than estimating them, while @roberts2006investigating introduces a model that is equivalent to one that assumes $s_{1}$ is linear. While are all viable statistical methods, they lack the GAIM's combination of extensibility and interpretability. 

@davalos2017current also discusses non-parametric methods, including Bayesian Kernel Machine Regression (BKMR). BKMR allows for estimation and variable selection. It was introduced in @bobb2015bayesian, and an R package was released in 2018 [@bobb2018statistical]. BKMR was developed to address estimation difficulties that arise when dealing with mixtures of pollutant exposures, and models the exposure-response surface as a (smooth) kernel function. For example, the exposures can be air pollutants and the response nonaccidental mortality. Using a hierarchical Bayesian variable selection method, BKMR can also select one pollutant from a group of correlated ones. BMKR  is interpreted by visualizing cross-sections of the exposure-response surface, as it does *not* have easily interpretable parameters. In comparison, the GAIM proposed here does *have* interpretable parameters.

While there has been significant research interest in the multiple pollutant problem, the models being used have either computational limitation or limited interpretability. In constrast, the GAIM has interpretable parameters and its computational burden does *not* scale with the dimensionality of its inputs. The GAIM model has applications wherever the natural target of inference is a mixture of covariates that may relate nonlinearly to the outcome of interest. 

### Question 2

The relationship between daily coronavirus deaths and air pollution levels has become an active area of research in recent months. For instance, @wu2020exposure finds that a 1 $\mu$g increase in long-term exposure to ambient PM~2.5~ increases the coronavirus death rate by 15%. Additional studies that examine this relationship include @conticini2020can, @sciomer2020sars, and @setti2020searching. 

However, much work remains to be done. For instance, non-COVID-19 daily mortality data is generally not yet available, such that we do not have an accurate measure of *excess* deaths attributable to COVID-19. These excess deaths could be attributable to under-reported COVID-19 case and death counts (due to limited testing), restricted access to care for patients with other health conditions, or potential reporting delays. Moreover, cumulative COVID-19 mortality will likely continue to rise for some time, making the question of excess deaths due to COVID-19 best suited for an ongoing inquiry that help inform public health responses. 


## References 

<div id="refs"></div>


\newpage 
# Anticipated roles of trainees (students and post-doctoral fellows)

<!-- Limit to 1/2 page. Full details will be included in the full proposal --> 

Kamal will develop the Bayesian implementation of the multiple pollutant models in Stan. This includes exploring determining appropriate prior distributions for the weights $\alpha$ and developing visualizations that communicate model results in a simple and interpretable way. He will be responsible for producing paper(s) summarizing the results of this model when run on Canadian air pollution and mortality data. To facilitate team communication and cohesion, he will also split time between Toronto (at the Centre for Global Health Research) and Ottawa (at the University of Ottawa), and use the proximity to Quebec to visit the collaborators there.  

The University of Toronto PhD student will compare the results from the Bayesian random walk models to those obtained from non-MCMC methods. For example, these could include frequentist methods that fit (natural cubic) splines or Bayesian inference using R-INLA [@rue2009approximate]. The University of Laval/University of Ottawa PhD student will compare the results from the Stan implementation to those obtained by a case-crossover model. 


<!-- 
### Anticipated organization of collaborations

Not necessary in the LOI. This will be included in the full proposal. 
--> 

# Plans for dissemination and communication

<!-- Limit to 5 sentences. This will be expanded in a full proposal. -->

The results and findings of this multiple pollutant inquiry will be shared with Health Canada and the Institut National de Santé Publique du Québec. The lead investigators have a track record of publishing their research results in statistical and epidemiolgical journals, and aim to publish the results of this project in high-impact journals. They (or the trainees) will also attend appropriate conferences to present the work while it in progress.


# Suggested reviewers

I've asked Patrick to suggest three potential reviewers.

# Five CVs

<!-- Degrees, current position(s), selected peer-reviewed publications (last 6 years), other evidence of impact and contributions (last 6 years), and numbers of undergraduate, master’s level, PhD level and postdoctoral trainees (last 6 years). --> 

  - Patrick, Fateh, Hwashin, Meredith (?), Cindy  


# Preliminary budget description

<!-- Limit to 1/4 of a page. This will be expanded in a full proposal. --> 

The CANSSI Collaborative Research Team (CRT) grant is for $180,000 over 3 years. We propose the budget:

  1. $30,000/year to support post-doctoral funding.
  2. $12,000/year to support a Laval University or University of Ottawa PhD student.
  3. $12,000/year to support a University of Toronto PhD student.
  4. $6,000/year to support travel to/from the cities of the lead investigators -- Toronto, Ottawa, and Quebec -- and annual team meetings held around the Statistical Society of Canada conference.
